import{S as R,i as J,s as X,n as O,d as I,b as P,D as w,e as D,P as S,j as C,Q as me,z as he,o as z,p as y,a as we,x as Z,v as x,U as ee,c as L,C as $,f as U,g as Ie,h as H,t as Le,k as M,l as ge,m as j,q as A,r as B,u as q,O as De,F as te,V as ne}from"../chunks/Dl-CPQHr.js";import"../chunks/IHki7fMi.js";import{u as _e}from"../chunks/XqiliRdc.js";import"../chunks/Dn3xmJ9Z.js";import{e as Q}from"../chunks/r7f6XsU6.js";import{A as le}from"../chunks/B8Bu-ZRe.js";import{E as Ce}from"../chunks/CcuyOR0G.js";import{g as ie}from"../chunks/CySb9U9S.js";import{s as Ee}from"../chunks/CPbIu-fp.js";function ye(i){let e,n='<div class="head svelte-1epg30x"><span>Quizzes</span></div> <div class="hori-divider svelte-1epg30x"></div>';return{c(){e=C("div"),e.innerHTML=n,this.h()},l(t){e=D(t,"DIV",{class:!0,"data-svelte-h":!0}),S(e)!=="svelte-m5xug2"&&(e.innerHTML=n),this.h()},h(){w(e,"class","top-nav svelte-1epg30x")},m(t,l){P(t,e,l)},p:O,i:O,o:O,d(t){t&&I(e)}}}function Ve(i,e,n){let{nextWeek:t}=e;return i.$$set=l=>{"nextWeek"in l&&n(0,t=l.nextWeek)},[t]}let ze=class extends R{constructor(e){super(),J(this,e,Ve,ye,X,{nextWeek:0})}};function se(i,e,n){const t=i.slice();return t[8]=e[n],t}function re(i){let e,n='<i class="fa fa-link"></i>',t,l;return{c(){e=C("div"),e.innerHTML=n,this.h()},l(s){e=D(s,"DIV",{class:!0,"data-svelte-h":!0}),S(e)!=="svelte-1cemmzl"&&(e.innerHTML=n),this.h()},h(){w(e,"class","btn btn-warning")},m(s,a){P(s,e,a),t||(l=$(e,"click",i[5]),t=!0)},p:O,d(s){s&&I(e),t=!1,l()}}}function ae(i){let e,n;return e=new pe({props:{selectedGame:i[1],game:i[8],selectGame:i[2],visitGame:i[3]}}),{c(){q(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,l){A(e,t,l),n=!0},p(t,l){const s={};l&2&&(s.selectedGame=t[1]),l&1&&(s.game=t[8]),l&4&&(s.selectGame=t[2]),l&8&&(s.visitGame=t[3]),e.$set(s)},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){j(e,t)}}}function Te(i){let e,n,t=i[0].title+"",l,s,a,r,f='<i class="fa fa-eye"></i>',m,b,v,G,K,_=i[4]&&i[4].admin&&re(i),V=Q(i[0].children||[]),h=[];for(let u=0;u<V.length;u+=1)h[u]=ae(se(i,V,u));const E=u=>z(h[u],1,1,()=>{h[u]=null});return{c(){e=C("li"),n=C("div"),l=Le(t),s=M(),_&&_.c(),a=M(),r=C("div"),r.innerHTML=f,m=M(),b=C("div");for(let u=0;u<h.length;u+=1)h[u].c();this.h()},l(u){e=D(u,"LI",{class:!0});var d=U(e);n=D(d,"DIV",{class:!0});var o=U(n);l=Ie(o,t),s=H(o),_&&_.l(o),a=H(o),r=D(o,"DIV",{class:!0,"data-svelte-h":!0}),S(r)!=="svelte-xrzsej"&&(r.innerHTML=f),o.forEach(I),m=H(d),b=D(d,"DIV",{class:!0});var c=U(b);for(let g=0;g<h.length;g+=1)h[g].l(c);c.forEach(I),d.forEach(I),this.h()},h(){w(r,"class","btn btn-outline-primary"),w(n,"class","head svelte-zxslae"),w(b,"class","children svelte-zxslae"),w(e,"class","game svelte-zxslae"),ee(e,"selected",i[1]?i[1].id===i[0].id:!1)},m(u,d){P(u,e,d),L(e,n),L(n,l),L(n,s),_&&_.m(n,null),L(n,a),L(n,r),L(e,m),L(e,b);for(let o=0;o<h.length;o+=1)h[o]&&h[o].m(b,null);v=!0,G||(K=[$(r,"click",i[6]),$(n,"click",i[7])],G=!0)},p(u,[d]){if((!v||d&1)&&t!==(t=u[0].title+"")&&we(l,t),u[4]&&u[4].admin?_?_.p(u,d):(_=re(u),_.c(),_.m(n,a)):_&&(_.d(1),_=null),d&15){V=Q(u[0].children||[]);let o;for(o=0;o<V.length;o+=1){const c=se(u,V,o);h[o]?(h[o].p(c,d),y(h[o],1)):(h[o]=ae(c),h[o].c(),y(h[o],1),h[o].m(b,null))}for(Z(),o=V.length;o<h.length;o+=1)E(o);x()}(!v||d&3)&&ee(e,"selected",u[1]?u[1].id===u[0].id:!1)},i(u){if(!v){for(let d=0;d<V.length;d+=1)y(h[d]);v=!0}},o(u){h=h.filter(Boolean);for(let d=0;d<h.length;d+=1)z(h[d]);v=!1},d(u){u&&I(e),_&&_.d(),me(h,u),G=!1,he(K)}}}function Pe(i,e,n){let t;ge(i,_e,v=>n(4,t=v));let{game:l}=e,{selectedGame:s}=e,{selectGame:a}=e,{visitGame:r}=e;const f=()=>{ie(`/games/${l.id}/edit`)},m=()=>{ie(`/games/${l.id}`)},b=()=>a(l);return i.$$set=v=>{"game"in v&&n(0,l=v.game),"selectedGame"in v&&n(1,s=v.selectedGame),"selectGame"in v&&n(2,a=v.selectGame),"visitGame"in v&&n(3,r=v.visitGame)},[l,s,a,r,t,f,m,b]}class pe extends R{constructor(e){super(),J(this,e,Pe,Te,X,{game:0,selectedGame:1,selectGame:2,visitGame:3})}}function oe(i,e,n){const t=i.slice();return t[18]=e[n],t}function ce(i){let e,n,t,l,s='<i class="fa fa-plus"></i>',a,r;return{c(){e=C("div"),n=C("input"),t=M(),l=C("div"),l.innerHTML=s,this.h()},l(f){e=D(f,"DIV",{class:!0});var m=U(e);n=D(m,"INPUT",{type:!0,class:!0,placeholder:!0}),t=H(m),l=D(m,"DIV",{class:!0,"data-svelte-h":!0}),S(l)!=="svelte-hrys9y"&&(l.innerHTML=s),m.forEach(I),this.h()},h(){w(n,"type","text"),w(n,"class","form-control"),w(n,"placeholder","Create Game"),w(l,"class","btn btn-info"),w(e,"class","createGame inline-form")},m(f,m){P(f,e,m),L(e,n),ne(n,i[5]),L(e,t),L(e,l),a||(r=[$(n,"input",i[11]),$(l,"click",i[10])],a=!0)},p(f,m){m&32&&n.value!==f[5]&&ne(n,f[5])},d(f){f&&I(e),a=!1,he(r)}}}function He(i){let e,n;return e=new Ce({props:{selectedGame:i[1],goBack:i[12]}}),{c(){q(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,l){A(e,t,l),n=!0},p(t,l){const s={};l&2&&(s.selectedGame=t[1]),l&2&&(s.goBack=t[12]),e.$set(s)},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){j(e,t)}}}function Me(i){let e,n,t=Q(i[2]||[]),l=[];for(let a=0;a<t.length;a+=1)l[a]=fe(oe(i,t,a));const s=a=>z(l[a],1,1,()=>{l[a]=null});return{c(){e=C("ul");for(let a=0;a<l.length;a+=1)l[a].c();this.h()},l(a){e=D(a,"UL",{class:!0});var r=U(e);for(let f=0;f<l.length;f+=1)l[f].l(r);r.forEach(I),this.h()},h(){w(e,"class","clean-list games")},m(a,r){P(a,e,r);for(let f=0;f<l.length;f+=1)l[f]&&l[f].m(e,null);n=!0},p(a,r){if(r&773){t=Q(a[2]||[]);let f;for(f=0;f<t.length;f+=1){const m=oe(a,t,f);l[f]?(l[f].p(m,r),y(l[f],1)):(l[f]=fe(m),l[f].c(),y(l[f],1),l[f].m(e,null))}for(Z(),f=t.length;f<l.length;f+=1)s(f);x()}},i(a){if(!n){for(let r=0;r<t.length;r+=1)y(l[r]);n=!0}},o(a){l=l.filter(Boolean);for(let r=0;r<l.length;r+=1)z(l[r]);n=!1},d(a){a&&I(e),me(l,a)}}}function fe(i){let e,n;return e=new pe({props:{selectedGame:i[0],game:i[18],selectGame:i[8],visitGame:i[9]}}),{c(){q(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,l){A(e,t,l),n=!0},p(t,l){const s={};l&1&&(s.selectedGame=t[0]),l&4&&(s.game=t[18]),e.$set(s)},i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){j(e,t)}}}function Ue(i){let e,n='<i class="fa fa-check"></i>';return{c(){e=C("div"),e.innerHTML=n,this.h()},l(t){e=D(t,"DIV",{class:!0,"data-svelte-h":!0}),S(e)!=="svelte-1i6i9n1"&&(e.innerHTML=n),this.h()},h(){w(e,"class","btn btn-success")},m(t,l){P(t,e,l)},p:O,d(t){t&&I(e)}}}function Ke(i){let e,n="Unsaved Progress",t,l;return{c(){e=C("div"),e.textContent=n,this.h()},l(s){e=D(s,"DIV",{class:!0,"data-svelte-h":!0}),S(e)!=="svelte-llhlhm"&&(e.textContent=n),this.h()},h(){w(e,"class","btn btn-warning")},m(s,a){P(s,e,a),t||(l=$(e,"click",i[7]),t=!0)},p:O,d(s){s&&I(e),t=!1,l()}}}function ue(i){let e,n="Saving";return{c(){e=C("div"),e.textContent=n,this.h()},l(t){e=D(t,"DIV",{class:!0,"data-svelte-h":!0}),S(e)!=="svelte-iwm6s2"&&(e.textContent=n),this.h()},h(){w(e,"class","btn btn-info")},m(t,l){P(t,e,l)},d(t){t&&I(e)}}}function Ne(i){let e,n,t,l,s,a,r,f,m,b,v;n=new ze({});let G=i[6]&&i[6].admin&&ce(i);const K=[Me,He],_=[];function V(o,c){return o[1]?1:0}a=V(i),r=_[a]=K[a](i);function h(o,c){return o[3]&&!o[4]?Ke:Ue}let E=h(i),u=E(i),d=i[4]&&ue();return{c(){e=C("div"),q(n.$$.fragment),t=M(),G&&G.c(),l=M(),s=C("div"),r.c(),f=M(),m=C("div"),u.c(),b=M(),d&&d.c(),this.h()},l(o){e=D(o,"DIV",{class:!0});var c=U(e);B(n.$$.fragment,c),t=H(c),G&&G.l(c),l=H(c),s=D(c,"DIV",{class:!0});var g=U(s);r.l(g),g.forEach(I),f=H(c),m=D(c,"DIV",{class:!0});var k=U(m);u.l(k),b=H(k),d&&d.l(k),k.forEach(I),c.forEach(I),this.h()},h(){w(s,"class","wrapper svelte-1ftmnlt"),w(m,"class","saveProgress svelte-1ftmnlt"),w(e,"class","content")},m(o,c){P(o,e,c),A(n,e,null),L(e,t),G&&G.m(e,null),L(e,l),L(e,s),_[a].m(s,null),L(e,f),L(e,m),u.m(m,null),L(m,b),d&&d.m(m,null),v=!0},p(o,[c]){o[6]&&o[6].admin?G?G.p(o,c):(G=ce(o),G.c(),G.m(e,l)):G&&(G.d(1),G=null);let g=a;a=V(o),a===g?_[a].p(o,c):(Z(),z(_[g],1,1,()=>{_[g]=null}),x(),r=_[a],r?r.p(o,c):(r=_[a]=K[a](o),r.c()),y(r,1),r.m(s,null)),E===(E=h(o))&&u?u.p(o,c):(u.d(1),u=E(o),u&&(u.c(),u.m(m,b))),o[4]?d||(d=ue(),d.c(),d.m(m,null)):d&&(d.d(1),d=null)},i(o){v||(y(n.$$.fragment,o),y(r),v=!0)},o(o){z(n.$$.fragment,o),z(r),v=!1},d(o){o&&I(e),j(n),G&&G.d(),_[a].d(),u.d(),d&&d.d()}}}function ve(i){if(i){for(let e=0;e<i.length;e++)i[e].position=e+1,i[e].children=ve(i[e].children);return i}}function de(i,e,n){const t=i[e];i[e]=i[n],i[n]=t}function ke(i){return i.reduce((e,n)=>(e.push(n),n.children&&e.push(...ke(n.children)),e),[])}function Ge(i,e){for(let n of i){if(n.children&&n.children.some(t=>t.id===e))return n.id;if(n.children){const t=Ge(n.children,e);if(t!==null)return t}}return null}function F(i,e){for(let n of i){if(n.id===e)return n;if(n.children){const t=F(n.children,e);if(t!==null)return t}}return null}function be(i,e){for(let n of i){if(n.children&&n.children.some(t=>t.id===e))return n.children;if(n.children){const t=be(n.children,e);if(t.length>0)return console.log("FOUND IN CHILDREN"),t}}return[]}function Y(i,e=null){return i.filter(l=>l.game_id===e).map(l=>{const s=Y(i,l.id);return{...l,children:s}})}function Oe(i,e,n){let t;ge(i,_e,c=>n(6,t=c));let l=[],s=null,a=null,r=[],f=!1,m=!1;De(async()=>{l=await le.get("/games.json"),console.log("first game fetch",l),n(2,r=Y(l)),console.log("organized games",r)}),te(()=>(window.addEventListener("keydown",b),()=>{window.removeEventListener("keydown",b)})),te(()=>(window.addEventListener("keydown",b),()=>{window.removeEventListener("keydown",b)}));function b(c){if(!s||!r)return;let g=-1,k=be(r,s.id);s.game_id?g=k.findIndex(p=>p.id===s.id):(k=r,g=r.findIndex(p=>p.id===s.id)),c.key==="s"||c.key==="w"?G(c,k,g):c.key==="d"?K(k):c.key==="a"&&_(k,g),n(2,r=r.map(p=>p.id===s.id&&s.game_id?{...p,children:[...k]}:p)),n(3,f=!0)}async function v(){n(4,m=!0);const c=ve(r);await Ee("/games/reorder",{list:ke(c).map(g=>({id:g.id,game_id:g.game_id,position:g.position}))}),n(4,m=!1),n(3,f=!1)}function G(c,g,k){s&&(console.log(g?{container:g}:"no parent"),c.key==="s"&&k<g.length-1?de(g,k,k+1):c.key==="w"&&k>0&&de(g,k,k-1))}function K(c,g){const k=c.indexOf(s),p=k-1;if(console.log({futureParentIndex:p}),p>=0&&p<c.length-1){const T=c.splice(k,1)[0];n(0,s.game_id=c[p].id,s),c[p].children||(c[p].children=[]),c[p].children=[...c[p].children,T]}}function _(c,g){if(!(!s||!s.game_id)){const k=Ge(r,s.game_id);let p,T,W;if(k!==null?(p=F(r,k),T=F(r,s.game_id),W=p.children.findIndex(N=>N.id===T.id),console.log({newParent:p}),console.log({currentParent:T}),console.log({currentParentIndex:W})):(p=r,T=F(r,s.game_id),W=p.findIndex(N=>N.id===T.id)),W>=0){const N=T.children.splice(g,1)[0];console.log(T.children),N.game_id=p.id,Array.isArray(p)?p.splice(W+1,0,N):p.children.splice(W+1,0,N);return}return}}function V(c){n(0,s=c),console.log({selectedGame:s})}function h(c){n(1,a=c),console.log({visitingGame:a})}let E;async function u(){if(E.length<2)return;const c=await le.post("/games",{title:E,positon:r.length+1});console.log({res:c}),l=[...l,c],n(2,r=Y(l)),n(5,E="")}function d(){E=this.value,n(5,E)}return[s,a,r,f,m,E,t,v,V,h,u,d,()=>n(1,a=null)]}class Se extends R{constructor(e){super(),J(this,e,Oe,Ne,X,{})}}function We(i){let e,n;return e=new Se({}),{c(){q(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,l){A(e,t,l),n=!0},p:O,i(t){n||(y(e.$$.fragment,t),n=!0)},o(t){z(e.$$.fragment,t),n=!1},d(t){j(e,t)}}}class Ye extends R{constructor(e){super(),J(this,e,null,We,X,{})}}export{Ye as component};
